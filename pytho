from playwright.sync_api import sync_playwright
import pandas as pd

# Start Playwright
with sync_playwright() as p:
    # Launch the browser
    browser = p.chromium.launch(headless=True)  # Set headless=False to see the browser
    page = browser.new_page()

    # Open the website
    url = "https://quotes.toscrape.com/"  # Sample site to scrape
    page.goto(url)

    # Extract Data
    quotes = page.locator(".quote").all()
    data = []

    for quote in quotes:
        text = quote.locator(".text").inner_text()
        author = quote.locator(".author").inner_text()
        tags = [tag.inner_text() for tag in quote.locator(".tags .tag").all()]
        data.append({"Quote": text, "Author": author, "Tags": ", ".join(tags)})

    # Convert to DataFrame
    df = pd.DataFrame(data)
    
    # Save to Excel
    df.to_excel("scraped_quotes.xlsx", index=False)

    print("âœ… Scraping complete! Data saved to scraped_quotes.xlsx")

    # Close browser
    browser.close()
